<!DOCTYPE html>
<html>

<head>
	<title>Mali Health Sites Map</title>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
	<style>
		body {
			margin: 0px;
		}

		h1 {
			float: left;
			padding-left: 10px;
			font-family: Helvetica, Arial, Verdana;
			font-size: 42px
		}

		p {
			font-family: Helvetica, Arial, Verdana;
			font-size: 18px;
			padding-left: 10px;
		}

		#wrapper {
			width: 800px;
		}

		#map {
			width: 780px;
			margin: 0 auto;
			height: 500px;
		}

		#controls {
			width: 100%;
			margin: 0 auto;
			padding: 15px;
		}

		#narrative {
			width: 780px;
			height: 500px;
			margin: 0 auto;
			padding: 15px;
		}

		#header {
			margin-top: 0px;
			margin-bottom: 0px;
		}
	</style>
</head>

<body>
	<!-- Web map & content will go here.  -->
	<div id="wrapper">
		<div id="header">
			<h1>Malnutrition & Health Sites in Mali</h1>
		</div>
		<div id="map"></div>
		<div id="controls">
			<!-- Here is the code for a button if we were going to add them.
			<button class="button" id="toggleButton">BUTTON!</button>
			-->
			<div id="narrative">
				<p>You can put narrative text or explanation here.</p>
			</div>
		</div>
	</div>
	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script>
		// Create Map Object
		var map = L.map('map', {
			center: [16.396849, -2.167592],
			zoom: 5,
		});

		// Add Tile Layer
		L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
			attribution: '&copy; OpenStreetMap France | &copy; Tiles by <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a> | Data by <a href="https://data.humdata.org/dataset/wfp-geonode-ica-mali-prevalence-of-global-acute-malnutrition">World Food Programme</a> and <a href="https://data.humdata.org/dataset/mali-healthsites">OSM Contributors</a>',
			maxZoom: 18,
			minZoom: 2,
		}).addTo(map);

		// Add GeoJSON Data
		// Null variable that will hold Healthsites data
		var Healthsites = null;

		// Add GeoJSON Data to the map when it loads
		$.getJSON("data/Mali_healthsites.geojson", function(data) {
			// set Healthsites to the dataset and add the Healthsites GeoJSON layer to the map
			Healthsites = L.geoJson(data, {
				onEachFeature: function(feature, layer) {
					layer.bindPopup('<strong>Name: </strong>' + feature.properties.name + '</br><strong>Amenity: </strong>' + feature.properties.amenity);
				},
				pointToLayer: function(feature, latlng) {
					if (feature.properties.amenity == "clinic") { // Replacing previous marker with conditionals
						var marker = L.marker(latlng, {
							icon: clinicIcon
						});
					} else if (feature.properties.amenity == "dentist") {
						var marker = L.marker(latlng, {
							icon: dentistIcon
						});
					} else if (feature.properties.amenity == "doctors") {
						var marker = L.marker(latlng, {
							icon: doctorsIcon
						});
					} else if (feature.properties.amenity == "hospital") {
						var marker = L.marker(latlng, {
							icon: hospitalIcon
						});
					} else {
						var marker = L.marker(latlng, {
							icon: pharmacyIcon
						});
					};
					return marker;
				}
			}).addTo(map);
		});

		// Create Custom Icons Here
		// Start by creating a standard Health Icon
		var healthIcon = L.Icon.extend({ // adding the .extend and capital I!
			options: {
				iconUrl: 'icons/generichealth_LianeKirschner.png',
				iconSize: [24, 24],
				iconAnchor: [12, 12],
				popupAnchor: [0, -6]
			}
		});

		// Create specific icons for amenity types
		var clinicIcon = new healthIcon({
			iconUrl: 'icons/OCHA_clinic.png'
		});
		var dentistIcon = new healthIcon({
			iconUrl: 'icons/dentist_achmadmulyana.png'
		});
		var doctorsIcon = new healthIcon({
			iconUrl: 'icons/OCHA_doctor.png'
		});
		var hospitalIcon = new healthIcon({
			iconUrl: 'icons/OCHA_hospital.png'
		});
		var pharmacyIcon = new healthIcon({
			iconUrl: 'icons/OCHA_pharmacy.png'
		});

		// Add Admin unit Polygons
		// Null variable that will hold admin units layer
		var adminLayer = null;

		// Add Admin Polygons
		$.getJSON("data/Mali_Prevalence_Global_Acute_Malnutrition.geojson", function(data) {
			adminLayer = L.geoJson(data).addTo(map);
		});

		// Create Leaflet Control Object for Legend

		// Add Scale Bar to Map
	</script>
</body>

</html>
